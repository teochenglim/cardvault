<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CardVault</title>
<link rel="stylesheet" href="/static/styles.css">
</head>
<body>

<!-- Navbar -->
<nav class="navbar">
  <div class="nav-brand">CardVault <span id="cardCount"></span></div>
  <div class="search-wrap">
    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>
    <input id="searchBar" class="search-bar" type="search" placeholder="Search name, company, emailâ€¦" oninput="onSearch(this.value)">
  </div>
  <div class="nav-right">
    <button class="btn-primary" onclick="openModal(null)">+ Add Card</button>
    <button class="btn-icon" id="themeToggle" onclick="toggleTheme()" title="Toggle dark mode">ğŸŒ™</button>
  </div>
</nav>

<!-- Tag filter bar -->
<div class="tag-bar" id="tagBar">
  <span class="tag-bar-label">Filter:</span>
  <span id="tagChips"></span>
</div>

<!-- Card grid -->
<main class="card-grid" id="cardGrid"></main>

<!-- â”€â”€ Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
<div class="overlay" id="modalOverlay" onclick="overlayClick(event)">
  <div class="modal" onclick="event.stopPropagation()">
    <div class="modal-header">
      <h2 id="modalTitle">Add Card</h2>
      <button class="btn-icon" onclick="closeModal()">âœ•</button>
    </div>
    <div class="modal-tabs" id="modalTabs">
      <button class="modal-tab active" data-tab="basic"   onclick="switchTab('basic')">Basic Info</button>
      <button class="modal-tab"        data-tab="contact" onclick="switchTab('contact')">Contact</button>
      <button class="modal-tab"        data-tab="address" onclick="switchTab('address')">Address</button>
      <button class="modal-tab"        data-tab="tags"    onclick="switchTab('tags')">Tags &amp; Notes</button>
    </div>
    <div class="modal-body">
      <!-- Basic Info -->
      <div class="tab-panel active" id="tab-basic">
        <div class="photo-section">
          <div class="photo-preview" id="photoPreview" onclick="document.getElementById('photoFile').click()">ğŸ“·</div>
          <div class="photo-actions">
            <div class="photo-drop" id="photoDrop" onclick="document.getElementById('photoFile').click()">
              <input type="file" id="photoFile" accept="image/jpeg,image/png,image/webp" onchange="onPhotoSelect(event)">
              Drag &amp; drop a photo or <strong>click to browse</strong><br>
              <small>JPG, PNG, WebP Â· max 5 MB</small>
            </div>
            <button id="removePhotoBtn" class="btn-sm danger" style="display:none;margin-top:6px" onclick="removePhoto()">Remove photo</button>
          </div>
        </div>
        <div class="form-group">
          <label>Name <span style="color:var(--danger)">*</span></label>
          <input id="f-name" class="form-input" type="text" placeholder="Full name" required>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>Job Title</label>
            <input id="f-title" class="form-input" type="text" placeholder="e.g. Software Engineer">
          </div>
          <div class="form-group">
            <label>Company</label>
            <input id="f-company" class="form-input" type="text" placeholder="e.g. Acme Corp">
          </div>
        </div>
        <div class="form-group">
          <label>Website</label>
          <input id="f-website" class="form-input" type="url" placeholder="https://â€¦">
        </div>
      </div>

      <!-- Contact -->
      <div class="tab-panel" id="tab-contact">
        <div class="dynamic-section">
          <div class="dynamic-section-title">ğŸ“± Phones</div>
          <div id="phoneRows"></div>
          <button class="add-row-btn" onclick="addPhone()">+ Add phone</button>
        </div>
        <div class="dynamic-section">
          <div class="dynamic-section-title">ğŸ“§ Emails</div>
          <div id="emailRows"></div>
          <button class="add-row-btn" onclick="addEmail()">+ Add email</button>
        </div>
      </div>

      <!-- Address -->
      <div class="tab-panel" id="tab-address">
        <div class="dynamic-section">
          <div class="dynamic-section-title">ğŸ“ Addresses</div>
          <div id="addressRows"></div>
          <button class="add-row-btn" onclick="addAddress()">+ Add address</button>
        </div>
      </div>

      <!-- Tags & Notes -->
      <div class="tab-panel" id="tab-tags">
        <div class="form-group">
          <label>Tags</label>
          <div class="tag-input-wrap" id="tagInputWrap" onclick="document.getElementById('tagInput').focus()">
            <div id="tagPills"></div>
            <input id="tagInput" class="tag-input" placeholder="Type tag, press Enter or comma" onkeydown="onTagKey(event)" oninput="onTagInput(event)">
          </div>
          <small style="color:var(--text-muted);font-size:.78rem;margin-top:4px;display:block">Press Enter or comma to add</small>
        </div>
        <div class="form-group">
          <label>Notes</label>
          <textarea id="f-notes" class="form-input form-textarea" placeholder="Any notes about this contactâ€¦"></textarea>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <div>
        <button id="deleteCardBtn" class="btn-danger" style="display:none" onclick="confirmDeleteCurrent()">Delete Card</button>
      </div>
      <div class="modal-footer-right">
        <button class="btn-secondary" onclick="closeModal()">Cancel</button>
        <button class="btn-primary" onclick="saveCard()">Save</button>
      </div>
    </div>
  </div>
</div>

<!-- Confirm overlay -->
<div class="overlay" id="confirmOverlay">
  <div class="confirm-box">
    <h3>Confirm Delete</h3>
    <p id="confirmMsg">Are you sure?</p>
    <div class="confirm-actions">
      <button class="btn-secondary" onclick="closeConfirm()">Cancel</button>
      <button class="btn-danger"    onclick="doConfirm()">Delete</button>
    </div>
  </div>
</div>

<!-- Toast container -->
<div class="toast-container" id="toasts"></div>

<script src="/static/app.js"></script>
</body>
</html>
